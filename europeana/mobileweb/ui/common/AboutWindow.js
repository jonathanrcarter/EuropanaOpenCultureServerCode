var globals=require("/ui/common/globals"),css=require("/ui/common/css"),ajax=require("/helpers/ajax");
function fn(){var c=Titanium.UI.createWindow({navBarHidden:!0,backgroundColor:"#000"}),b=Titanium.UI.createButton({image:"/images/glyphicons_050_link.png"});b.addEventListener("click",function(){new (require("/ui/common/AddLinkWindow"))(require("/helpers/LocalStorage").getString("myself"),1)});b=Titanium.UI.iOS.createToolbar({top:0,right:0,left:0,height:40,items:[b],barColor:"#000000",borderTop:!1,borderBottom:!0});c.add(b);var b=Titanium.UI.createView({width:300,top:40,left:0,height:"100%",borderWidth:0,
borderColor:"#f00",layout:"vertical"}),f=Titanium.UI.createScrollView({contentHeight:"auto",contentWidth:"auto",width:600,top:40,left:300,height:"100%",borderWidth:0,borderColor:"#0f0",layout:"vertical"});Titanium.UI.createView({left:600,right:0,height:"100%",borderWidth:1,borderColor:"#00f",layout:"vertical"});var d=Titanium.UI.createTextField({left:5,right:5,top:5,bottom:5,height:20,autocorrect:!1,autocapitalization:!1,font:{fontFamily:"STHeitiTC-Medium"},value:require("/helpers/LocalStorage").getString("myusername"),
backgroundColor:"#eeeeee"}),g=Titanium.UI.createLabel({left:5,right:5,top:5,height:"auto",color:"#fff",font:{fontFamily:"STHeitiTC-Medium"}}),j=function(a,b){ajax.getdata({url:"http://aws2.glimworm.com/api.php",data:{action:"console-add-node",title:a,link:a,type:"person"},fn:function(a){b.call(this,a.data)}})},k=function(){ajax.getdata({url:"http://aws2.glimworm.com/api.php",data:{action:"json-get-rel-out",from:require("/helpers/LocalStorage").getString("myself")},fn:function(a){require("/helpers/LocalStorage").setObject("myrels",
a.data.items);require("/helpers/LocalStorage").setObject("myrels1",a.data.items2);for(var a=require("/helpers/LocalStorage").getObject("myrels1"),b=[],e=0;e<a.length;e++){var c=Titanium.UI.createTableViewRow({xlink:a[e].data.lnk,backgroundColor:"#000",color:"#fff",height:40,font:{fontFamily:"STHeitiTC-Medium"}}),d=Titanium.UI.createLabel({text:"Relationship to :"+a[e].data.title,xlink:a[e].data.lnk,color:"#fff",height:"auto",font:{fontFamily:"STHeitiTC-Medium"}});c.add(d);b.push(c)}h.setData(b)}})},
l=function(a){i.call(this,a);k()},i=function(a){a&&a.self?(g.text="Your ID is "+a.self,require("/helpers/LocalStorage").setString("myself",a.self),require("/helpers/LocalStorage").setObject("myselfobj",a)):g.text="There is no node for "+require("/helpers/LocalStorage").getString("myusername")+a};d.addEventListener("return",function(){require("/helpers/LocalStorage").setString("myusername",d.getValue());j(d.getValue(),l)});b.add(d);b.add(g);i(require("/helpers/LocalStorage").getObject("myselfobj"));
var m=Titanium.UI.createLabel({height:"auto",left:0,right:0,top:0,color:"#fff",font:{fontFamily:"STHeitiTC-Medium"}});f.add(m);var h=Titanium.UI.createTableView({height:"auto",left:0,right:0,top:0,color:"#fff",backgroundColor:"#000",separatorColor:"#000",font:{fontFamily:"STHeitiTC-Medium"}});f.add(h);c.add(b);c.add(f);return c}module.exports=fn;