windowFunctions["Update Event"]=function(m){function n(){h.hide();var a={event_id:m.id,name:e.value},b;b=Date.parse(f.value+" "+i.value);if(isNaN(b))alert("Please enter a valid date/time"),f.focus();else{a.start_time=new Date(b);b=parseInt(j.value,10);isNaN(b)||(a.duration=b);if(0<d.value.length&&(a.recurring=d.value.toLowerCase(),!{daily:1,weekly:1,monthly:1,yearly:1}[a.recurring])){alert("Enter 'daily', 'weekly', 'monthly', or 'yearly'");d.focus();return}b=parseInt(k.value,10);isNaN(b)||(a.recurring_count=
b);Cloud.Events.update(a,function(a){a.success?alert("Updated!"):error(a);h.show()})}}var g=createWindow(),o=addBackButton(g),c=Ti.UI.createScrollView({top:o+u,contentHeight:"auto",layout:"vertical"});g.add(c);var e=Ti.UI.createTextField({hintText:"Name",top:10+u,left:10+u,right:10+u,height:40+u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED});c.add(e);var f=Ti.UI.createTextField({hintText:"Date",top:10+u,left:10+u,right:10+u,height:40+u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED});c.add(f);var i=Ti.UI.createTextField({hintText:"Time",
top:10+u,left:10+u,right:10+u,height:40+u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED});c.add(i);var j=Ti.UI.createTextField({hintText:"Duration (seconds)",top:10+u,left:10+u,right:10+u,height:40+u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,keyboardType:Ti.UI.KEYBOARD_NUMBER_PAD});c.add(j);var d=Ti.UI.createTextField({hintText:"Recurring",top:10+u,left:10+u,right:10+u,height:40+u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,autocapitalization:Ti.UI.TEXT_AUTOCAPITALIZATION_NONE});c.add(d);var k=Ti.UI.createTextField({hintText:"Recurring Count (0-1000)",
top:10+u,left:10+u,right:10+u,height:40+u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED,keyboardType:Ti.UI.KEYBOARD_NUMBER_PAD});c.add(k);var h=Ti.UI.createButton({title:"Update",top:10+u,left:10+u,right:10+u,bottom:10+u,height:40+u});c.add(h);h.addEventListener("click",n);for(var c=[e,f,i,j,d,k],l=0;l<c.length;l++)c[l].addEventListener("return",n);var p=Ti.UI.createLabel({text:"Loading, please wait...",textAlign:"center",top:o+u,right:0,bottom:0,left:0,backgroundColor:"#fff",zIndex:2});g.add(p);g.addEventListener("open",
function(){Cloud.Events.show({event_id:m.id},function(a){p.hide();if(a.success){var a=a.events[0],b=convertISOToDate(a.start_time);e.value=a.name;f.value=b.toLocaleDateString();i.value=b.toLocaleTimeString();a.duration&&(j.value=a.duration.toString());d.value=a.recurring||"";a.recurring_count&&(k.value=a.recurring_count.toString());e.focus()}else error(a)})});g.open()};