windowFunctions["Create Photo Collection"]=function(k){function i(){for(var a=0;a<b.length;a++){if(!b[a].value.length){b[a].focus();return}b[a].blur()}h.hide();Cloud.PhotoCollections.create({name:d.value,parent_collection_id:f},function(a){a.success?(alert("Created!"),d.value="",f=null):error(a);h.show()})}var c=createWindow(),a=addBackButton(c),a=Ti.UI.createScrollView({top:a+u,contentHeight:"auto",layout:"vertical"});c.add(a);var d=Ti.UI.createTextField({hintText:"Name",top:10+u,left:10+u,right:10+
u,height:40+u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED});a.add(d);var f,j=Ti.UI.createButton({title:"Choose Parent Collection",top:10+u,left:10+u,right:10+u,bottom:10+u,height:40+u});j.addEventListener("click",function(){function a(g){Cloud.PhotoCollections.search({user_id:g},function(a){if(a.success)if(0==a.collections.length)c.remove(e),alert("No photo collections exist! Create one first.");else{var g=[];g.push(Ti.UI.createTableViewRow({title:"No Collection",id:"",hasCheck:!f}));for(var b=0,
d=a.collections.length;b<d;b++)a.collections[b].id!=k.id&&g.push(Ti.UI.createTableViewRow({title:a.collections[b].name,id:a.collections[b].id,hasCheck:f==a.collections[b].id}));e.setData(g)}else c.remove(e),error(a)})}var e=Ti.UI.createTableView({backgroundColor:"#fff",data:[{title:"Loading, please wait..."}]});e.addEventListener("click",function(a){f=a.row.id;c.remove(e)});c.add(e);Cloud.Users.showMe(function(b){b.success?a(b.users[0].id):(e.setData([{title:b.error&&b.message||b}]),error(b))})});
a.add(j);var h=Ti.UI.createButton({title:"Create",top:10+u,left:10+u,right:10+u,bottom:10+u,height:40+u});a.add(h);h.addEventListener("click",i);for(var b=[d],a=0;a<b.length;a++)b[a].addEventListener("return",i);c.addEventListener("open",function(){d.focus()});c.open()};