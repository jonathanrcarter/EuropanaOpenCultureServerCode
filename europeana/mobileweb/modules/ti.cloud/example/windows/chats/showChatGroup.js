windowFunctions["Show Chat Group"]=function(a){function i(a){if(a.success)for(var b=0,d=a.chats.length;b<d;b++){var c=a.chats[b];if(!j[c.id]){j[c.id]=!0;e.where={updated_at:{$gt:c.updated_at}};var h=Ti.UI.createTableViewRow({}),f=Ti.UI.createView({height:Ti.UI.SIZE||"auto",backgroundColor:"#fff",borderColor:"#ccc",borderWeight:1});f.add(Ti.UI.createLabel({text:c.from.first_name+" "+c.from.last_name,textAlign:"left",top:10+u,right:10+u,left:10+u,font:{fontSize:9,fontWeight:"bold"},height:10+u}));f.add(Ti.UI.createLabel({text:(new Date(c.updated_at)).toLocaleTimeString(),
top:10+u,right:10+u,font:{fontSize:8},height:10+u,width:"auto"}));f.add(Ti.UI.createLabel({text:c.message,textAlign:"left",height:"auto",top:20+u,right:10+u,left:10+u,bottom:10+u}));h.add(f);0==g.data.length?g.appendRow(h):g.insertRowBefore(0,h)}}else error(a)}function k(){Cloud.Chats.query(e,i)}var e={},d={},j={};if(a.id)e.chat_group_id=d.chat_group_id=a.id;else if(a.ids)e.participate_ids=d.to_ids=a.ids.join(",");else{alert("Invalid use of Show Chat Groups! Must pass in id or ids!");return}var a=
createWindow(),l=addBackButton(a),b=Ti.UI.createTextField({hintText:"Enter chat message",top:l+10+u,left:10+u,right:10+u,height:40+u,borderStyle:Ti.UI.INPUT_BORDERSTYLE_ROUNDED});b.addEventListener("return",function(){b.value&&(d.message=b.value,b.value="",Cloud.Chats.create(d,i),b.focus())});a.add(b);var g=Ti.UI.createTableView({top:l+60+u,bottom:0});a.add(g);var m=setInterval(k,5E3);a.addEventListener("open",function(){b.focus();k()});a.addEventListener("close",function(){clearInterval(m)});a.open()};