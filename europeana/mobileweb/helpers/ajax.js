exports.xhr=[null,null,null];function ajax(){}exports.ajax=ajax;exports.getxhr=function(a){return this.xhr[a]};exports.getxhr=function(a){this.xhr[a]=a};exports.destroyxhr=function(a){this.xhr[a]=null};
exports.getdata=function(a){new ajax;if(!1==Ti.Network.online)alert(l.noconnectivity);else{a.index||(a.index=0);null!=this.xhr[a.index]&&this.xhr[a.index].abort();a.hideIndicator||Ti.App.fireEvent("show_indicator");var c=!0,e=a.method?a.method:"GET",f=a.timeout?a.timeout:3E4,g=a.type?a.type:"json";if(a.image){a.win=Titanium.UI.currentWindow;c=!1;e="POST";Titanium.UI.createProgressBar({width:200,height:50,min:0,max:1,value:0,style:Titanium.UI.iPhone.ProgressBarStyle.PLAIN,top:10,message:"Uploading Image",
font:{fontSize:12,fontWeight:"bold"},color:"#888"});var b=Titanium.Filesystem.getFile(Titanium.Filesystem.applicationDataDirectory,a.imageFileName).read();a.data.media=b}b=Ti.Network.createHTTPClient();this.xhr[a.index]=b;b.onload=function(){require("/helpers/ajax").destroyxhr(a.index);if(a.image)a.fn(this);else{try{setActIndMsg(l.loaded)}catch(b){}Titanium.API.debug("this.responseText");Titanium.API.debug(this.responseText);if("text"==g)a.fn.call(this,this.responseText);else{var d={};try{d=JSON.parse(this.responseText.trim())}catch(c){d=
{}}a.fn.call(this,d)}}a.hideIndicator||Ti.App.fireEvent("hide_indicator")};b.setTimeout(f);b.onerror=function(b){Titanium.API.debug("error");a.hideErrors||alert(b.error);this.xhr[a.index]=null;a.err&&a.err(b);a.hideIndicator||Ti.App.fireEvent("hide_indicator")};b.onreadystatechange=function(){};b.onsendstream=function(){};b.ondatastream=function(a){Titanium.API.debug(a)};b.open(e,a.url,c);b.send(a.data)}};