exports.iosversion=function(){if("iPhone OS"==Titanium.Platform.name){var c=Titanium.Platform.version.split(".");return parseInt(c[0])}return 0};
exports.facebook=function(c,e,f,b){if("android"===Ti.Platform.osname){if(b)return!1;var d=Ti.Android.createIntent({action:Ti.Android.ACTION_SEND,type:"text/plain"});d.putExtra(Ti.Android.EXTRA_TEXT,c);d.addCategory(Ti.Android.CATEGORY_DEFAULT);Ti.Android.currentActivity.startActivity(d)}else if(5<this.iosversion()&&Ti.Contacts.requestAuthorization(function(){var a=require("dk.napp.social");Ti.API.info("ios6 : isFacebookSupported "+a.isFacebookSupported());if(a.isFacebookSupported()){if(b)return!0;
a.facebook({text:c,image:e,url:f})}}),b)return!1};
exports.tweet=function(c,e,f,b){if("android"===Ti.Platform.osname){if(b)return!1;var d=Ti.Android.createIntent({action:Ti.Android.ACTION_SEND,type:"text/plain"});d.putExtra(Ti.Android.EXTRA_TEXT,c);d.addCategory(Ti.Android.CATEGORY_DEFAULT);Ti.Android.currentActivity.startActivity(d)}else{d=this.iosversion();if(5<d)Ti.Contacts.requestAuthorization(function(){var a=require("dk.napp.social");Ti.API.info("ios6 : istwittersupported "+a.isTwitterSupported());if(a.isTwitterSupported()){if(b)return!0;a.twitter({text:c,
image:e,url:f})}});else if(4<d)Ti.Contacts.requestAuthorization(function(a){Ti.API.debug("callback from authorize contacts");Ti.API.debug(a);a=require("com.glimworm.gyro213");Ti.API.info("social - share - tweet - Which twitter : "+a.whichTwitterSupported());Ti.API.info("social - share - tweet - Which twitter : continue1");if(b)return!0;Ti.API.info("social - share - tweet - Which twitter : continue2");a.isTwitterSupportedTest8({message:c,images:e&&""!=e?[e]:[],urls:f&&""!=f?[f]:[]});Ti.API.info("social - share - tweet - Which twitter : continue3")});
else if(b)return!1;if(b)return!1}};
exports.ShareButton=function(c,e,f){var b=this.tweet(c,e,f,!0),d=this.facebook(c,e,f,!0),a=[],g=[];!0==b&&(a.push("Share on Twitter"),g.push("twitter"));!0==d&&(a.push("Share on Facebook"),g.push("facebook"));a.push("Cancel");g.push("cancel");b=Titanium.UI.createOptionDialog({cancel:a.length-1,options:a,message:"",title:""});b.addEventListener("click",function(a){a=g[a.index];"twitter"==a&&require("/helpers/share").tweet(c,e,f);"facebook"==a&&require("/helpers/share").facebook(c,e,f)});return b};